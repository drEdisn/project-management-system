<div class="contianer sign-container">
  <div class="profile">
    <img src="../../../assets/profile-bg.jpg" alt="bg" class="profile__bg">
    <img src="../../../assets/profile-img.jpg" alt="avatar" class="profile__image">
    <span class="login">{{ login }}</span>
    <div class="profile__info" *ngIf="!isChange; else change">
      <div class="info__item">
        <span class="item__name">Name</span>
        <span class="item__name-value">{{ storageService.user?.name | titlecase }}</span>
        <button class="item__button button" (click)="onChange('name')">Change</button>
      </div>
      <div class="info__item">
        <span class="item__name">Password</span>
        <button class="item__button button" (click)="onChange('password')">Change</button>
      </div>
      <div class="info__item">
        <span class="item__name">Avatar</span>
        <label for="file-upload" class="file">
          <svg fill="white" xmlns="http://www.w3.org/2000/svg" height="24" width="24">
            <path
              d="M10.95 20.2H6.525q-2.375 0-4.037-1.625Q.825 16.95.825 14.6.825 12.575 2 11q1.175-1.575 3.125-2.025.65-2.325 2.563-3.75Q9.6 3.8 12 3.8q2.95 0 5.025 2.037 2.075 2.038 2.15 4.988 1.75.275 2.875 1.6 1.125 1.325 1.125 3.1 0 1.95-1.363 3.312Q20.45 20.2 18.5 20.2h-5.45v-7.05l1.65 1.6 1.45-1.475L12 9.125l-4.15 4.15L9.3 14.75l1.65-1.6Z" />
          </svg>
          Upload Image
        </label>
        <input id="file-upload" type="file" (change)="getImage($event)">
      </div>
    </div>
  </div>
</div>

<ng-template #change>
  <div class="profile__info">
    <form class="form" [formGroup]="form" (ngSubmit)="changeUser()">
      <div class="inputs">
        <app-input [nameTitle]="changeValue" [value]="form.controls">
          <input
            class="input"
            [type]="changeValue === 'password' ? changeValue : 'text'"
            [formControlName]="changeValue"
          >
        </app-input>
        <ng-container *ngTemplateOutlet="errors; context:getInput(form, changeValue)"></ng-container>
      </div>
      <div class="change__buttons">
        <button type="submit" class="change__confirm button" [disabled]="!form.valid">
          Confirm
        </button>
        <button type="button" class="change__back button" (click)="onChange(null)">
          Back
        </button>
      </div>
    </form>
    <app-modal *ngIf="modalService.isVisible"></app-modal>
  </div>
</ng-template>

<ng-template
  #errors
  let-errors="errors"
  let-touched="touched"
  >
  <div
    class="sign__error"
    *ngIf="errors?.required && touched"
  >
    This field is required *
  </div>
  <div
    class="sign__error"
    *ngIf="errors?.minlength && touched"
  >
    Minimal length is {{ errors?.minlength.requiredLength }}
  </div>
  <div
    class="sign__error"
    *ngIf="errors?.pattern && touched"
  >
    Your password is too simple
  </div>
</ng-template>